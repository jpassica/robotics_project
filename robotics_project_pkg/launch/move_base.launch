<launch>
    <arg name="robot_namespace" default=""/>
    <group ns="$(arg robot_namespace)">
        <node pkg="move_base" type="move_base" respawn="false" name="move_base" output="screen">
            <rosparam file="$(find robotics_project_pkg)/config/costmap_common_params.yaml" command="load" ns="global_costmap" />
            <rosparam file="$(find robotics_project_pkg)/config/costmap_common_params.yaml" command="load" ns="local_costmap" />
            <rosparam file="$(find robotics_project_pkg)/config/local_costmap_params.yaml" command="load" />
            <rosparam file="$(find robotics_project_pkg)/config/global_costmap_params.yaml" command="load" />
            <rosparam file="$(find robotics_project_pkg)/config/base_local_planner_params.yaml" command="load" />

            <!-- Set frames explicitly -->
            <param name="global_costmap/global_frame" value="map"/>
            <param name="global_costmap/robot_base_frame" value="base_footprint"/>
            <param name="local_costmap/global_frame" value="odom"/>
            <param name="local_costmap/robot_base_frame" value="base_footprint"/>
            
            <!-- Sensor frame override -->
            <param name="global_costmap/laser_scan_sensor/sensor_frame" value="laser_link"/>
            <param name="local_costmap/laser_scan_sensor/sensor_frame" value="laser_link"/>
            <param name="global_costmap/laser_scan_sensor/topic" value="scan"/>
            <param name="local_costmap/laser_scan_sensor/topic" value="scan"/>
            
            <!-- Global planner configuration -->
            <param name="base_global_planner" value="global_planner/GlobalPlanner"/>
            <param name="planner_frequency" value="1.0"/>
            <param name="planner_patience" value="5.0"/>
            
            <!-- Local planner configuration -->
            <param name="base_local_planner" value="base_local_planner/TrajectoryPlannerROS"/>
            <param name="controller_frequency" value="5.0"/>
            <param name="controller_patience" value="15.0"/>
            
            <!-- Enable costmap publishing for exploration -->
            <param name="global_costmap/publish_voxel_map" value="true"/>
        </node>
    </group>
</launch>
